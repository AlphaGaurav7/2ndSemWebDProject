<!Doctype html>
<html lang="en">
  <head>
    <title>Title</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  </head>
  <body>
      
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>

    <style>
        .file-selector {
          border: 5px dashed red;
          width: 440px;
          height: 272px;
        }
      </style>

        
    <div id="file-selector"></div>
        <ul id="output"></ul>
        <script>
            const fileSelector = document.getElementById('file-selector');
            const output = document.getElementById('output');
            if (window.FileList && window.File) {
                fileSelector.addEventListener('dragover', event => {
                event.stopPropagation();
                event.preventDefault();
                event.dataTransfer.dropEffect = 'copy';
                });
                fileSelector.addEventListener('drop', event => {
                    output.innerHTML = '';
                    event.stopPropagation();
                    event.preventDefault();
                    const files = event.dataTransfer.files;
                    for (let i = 0; i < files.length; i++) {
                        const li = document.createElement('li');
                        const file = files[i];
                        const name = file.name ? file.name : 'NOT SUPPORTED';
                        const type = file.type ? file.type : 'NOT SUPPORTED';
                        const size = file.size ? file.size : 'NOT SUPPORTED';
                        li.textContent = `name: ${name}, type: ${type}, size: ${size}`;
                        output.appendChild(li);
                    }
                }); 
            }
    </script>

    <input type="file" id="fileSelector" class = "file-selector" accept = "xlsx">
    <button class = "btn btn-prumary" id = "button">Convert</button>
    <br>
    <div>
        Select a file from your file browser, or drag and drop one in the bordered area
    </div>
        <script>
            const file_Selector = document.getElementById('fileSelector');
            file_Selector.addEventListener('change', (event) => {
                const fileList = event.target.files;
                // console.log(fileList);
            });
        </script>

<script>
    let selected_file;

    document.getElementById('fileSelector').addEventListener("change", (event) => {
        selected_file = event.target.files[0];
    })

    document.getElementById('button').addEventListener("click", () => {
        if (selected_file) {
            let file_reader = new FileReader();
            file_reader.readAsBinaryString(selected_file);
            file_reader.onload = (event) => {
                // console.log(event.target.result);

                let data = event.target.result;
                let workbook = XLSX.read(data, {type:"binary"});
                console.log(workbook);

                workbook.SheetNames.forEach(sheet => {
                    let rowObject = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet]);
                    console.log(rowObject);
                });
            }
        }
    })
</script>    
  </body>
</html>
